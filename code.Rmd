---
title: "Prelim EDa"
output:
  word_document: default
  html_document: default
---


```{r}
# Course: ECON 5330
# Title: EDA Assignment
# Date: Jan 22, 2019
# Author: Haodi Tu, Majorie Blanco, Joseph Thomson
```

```{r setup, include=FALSE}
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())
library(readr)
library(ggplot2)
library(mosaic)

```

```{r}
ss16ppr <- read_csv("csv_ppr/ss16ppr.csv")
```

+ This survey contains 30224 observations, and 284 variables
+ Select only a few of varibles to perform an EDA



```{r}
attr(ss16ppr$RT, "label") <- "Record Type"
attr(ss16ppr$RAC1P, "label") <- "Recoded detailed race code"
attr(ss16ppr$RAC2P, "label") <- "Recoded detailed race code"
attr(ss16ppr$RAC3P, "label") <- "Recoded detailed race code"
attr(ss16ppr$ENG, "label") <- "Ability to speak English"
attr(ss16ppr$DREM, "label") <- "Cognitive difficulty"
attr(ss16ppr$SCHL, "label") <- "Educational attainment"




ss16ppr$RAC1P <- as.factor(ss16ppr$RAC1P)
ss16ppr$RAC2P <- as.factor(ss16ppr$RAC2P)
ss16ppr$RAC3P <- as.factor(ss16ppr$RAC3P)
ss16ppr$SCHL <- as.factor(ss16ppr$SCHL)
```

We were asked to perform an exploratory data analysis (EDA) based on American Community Survey, and our research questions are: 1. In Puerto Rico, how does earnings vary by educational attainment? 2. How does earnigs vary by how well English is spoken? 

Based on these two questions, we needed several attributes from the survey, which are ss16ppr$RT, ss16ppr$RAC1P, ss16ppr$RAC2P, ss16ppr$RAC3P, ss16ppr$ENG, ss16ppr$DREM, ss16ppr$SCHL. In detail, we looked into race diversity, marital status, ability to speak English, cognitive difficulty, educational attainment, and gender in Puerto Rico.


## Recoded detailed race code
 
```{r}
#code to decode RAC1P
ss16ppr <- mutate(ss16ppr, RAC1P = derivedFactor(
  "White" = RAC1P == 1,
  "Black or African American" = RAC1P == 2,
  "American Indian" = RAC1P == 3,
  "Alaska Native" = RAC1P == 4,
  "American Indian and Alaska Native" = RAC1P == 5,
  "Asian" = RAC1P == 6,
  "Native Hawaiian and Other Pacific Islander" = RAC1P == 7,
  "Some Other " = RAC1P == 8,
  "Two or More Races" = RAC1P == 9,
  method ="first",
  .default = "NA"
))
ss16ppr %>%  group_by(RAC1P) %>% summarise(n()) 
```

+ In Puerto Rico, majority of people identify themselves as white.


```{r}
ggplot(ss16ppr,  aes(RAC1P)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

+ Most of people are white
+ Minority races include American Indian, American Indian and Alaska Native, Asian, Native Hawaiian and Other Pacific Islander can be eliminated


## Marital status

```{r}
#code to decode MAR
ss16ppr <- mutate(ss16ppr, MAR = derivedFactor(
  "Married" = MAR == 1,
  "Widowed" = MAR == 2,
  "Divorced" = MAR == 3,
  "Separated" = MAR == 4,
  "Never married or under 15 years old" = MAR == 5,
  method ="first",
  .default = "NA"
))
ss16ppr %>%  group_by(MAR) %>% summarise(n()) 
```

```{r}
ggplot(ss16ppr,  aes(MAR)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

## Ability to speak English

```{r}
#code to decode ENG
ss16ppr <- mutate(ss16ppr, ENG = derivedFactor(
  "NA" = (ENG == "1" | is.nan(ENG)),
  "Very well" = ENG == "2",
  "Well" = ENG == "3",
  "Not well" = ENG == "4",
  "Not at all" = ENG == "5",
  method ="first",
  .default = "NA"
))
ss16ppr %>%  group_by(ENG) %>% summarise(n()) 
```

+ About half of population do not speak English well


```{r}
ggplot(ss16ppr,  aes(ENG)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

## Cognitive difficulty 

```{r}
#code to decode DREM
ss16ppr <- mutate(ss16ppr, DREM = derivedFactor(
  "Very well" = DREM == "1",
  "Well" = DREM == "2",
  method ="first",
  .default = "NA"
))
ss16ppr %>%  group_by(DREM) %>% summarise(n()) 
```

+ Majority of people (approximately 88%) do not have cognitive difficulty


```{r}
ggplot(ss16ppr,  aes(DREM)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```
 
## Educational attainment
Note: 16 .Regular high school diploma

```{r}
ggplot(ss16ppr,  aes(SCHL)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

+ We will category people in four education level
    + People in sec 0 - 15 don't have diploma and are considered as no education 
    + People in sec 16 - 17 have high school education  
    + People in sec 18 - 21 have college education
    + People in sec 22 - 24 have after bachelor's education  


```{r}
ggplot(ss16ppr,  aes(AGEP)) +
  geom_histogram(stat="count")  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

## Sex 

```{r}
#code to decode SEX
ss16ppr <- mutate(ss16ppr, SEX = derivedFactor(
  "Male" = SEX == "1",
  "Female" = SEX == "2",
  method ="first",
  .default = "NA"
))
ss16ppr %>%  group_by(SEX) %>% summarise(n()) 
```

+ Gender is nearly equalized in Puerto Rico


```{r}
ggplot(ss16ppr,  aes(SEX)) +
  geom_bar()  +
  theme_minimal() + # minimal theme
  theme(axis.text.x = element_text(angle = 45, vjust = 1, 
                                   size = 12, hjust = 1))
```

